<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>MAXIMUM REALITY: CHAOS KARTS SIDE</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<style>
  body { margin: 0; background: #000; color: #0ff; font-family: sans-serif; overflow: hidden; touch-action: none; position: fixed; width: 100vw; height: 100vh; }
  canvas { display: block; width: 100%; height: 100%; }
  #ui { position: absolute; top: 15px; width: 100%; display: flex; justify-content: space-around; z-index: 10; font-weight: 800; text-shadow: 0 0 10px #0ff; pointer-events: none; }
  #controls { position: absolute; bottom: 30px; width: 100%; display: flex; justify-content: center; gap: 40px; z-index: 100; }
  .btn { width: 80px; height: 80px; background: rgba(0, 255, 255, 0.2); border: 3px solid #0ff; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 35px; color: white; -webkit-user-select: none; }
  #overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.9); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 200; }
</style>
</head>
<body>

<div id="ui">
  <div>MPH: <span id="speed">0</span></div>
  <div>SCORE: <span id="score">0</span></div>
</div>

<div id="overlay">
  <h1 style="color:#ff00ff;">CHAOS KARTS</h1>
  <p>SIDE-VIEW MODE</p>
  <button class="btn" style="width:140px; border-radius:15px;" onclick="startCountdown()">START</button>
</div>

<canvas id="gameCanvas"></canvas>

<div id="controls">
  <div id="btnJump" class="btn">ðŸš€</div>
  <div id="btnAction" class="btn">ðŸ§¨</div>
</div>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
let w, h;

// Assets
const imgAzul = new Image(); imgAzul.src = 'azul_front_kart.png';
const imgMochkil = new Image(); imgMochkil.src = 'mochkil_front_kart.png';
const imgPass = new Image(); imgPass.src = 'azul_mochkil_pass.png';

// State
let speed = 0, score = 0, gameActive = false, countdown = -1;
let groundX = 0, playerY = 0, playerVY = 0;
let obstacles = [];
let roadY;

function resize() {
  w = canvas.width = window.innerWidth;
  h = canvas.height = window.innerHeight;
  roadY = h * 0.7;
  playerY = roadY;
}
window.addEventListener("resize", resize);
resize();

function startCountdown() {
  document.getElementById('overlay').style.display = 'none';
  countdown = 3; speed = 0; score = 0; obstacles = [];
  const timer = setInterval(() => {
    countdown--;
    if (countdown < 0) { clearInterval(timer); gameActive = true; speed = 10; }
  }, 800);
}

// Controls: Space/Jump to dodge ðŸš§ or hit ðŸš€
window.addEventListener('touchstart', (e) => {
  if (!gameActive) return;
  if (playerY >= roadY) playerVY = -15; // Jump
});

function update() {
  if (!gameActive) return;

  speed = Math.min(20, speed + 0.05);
  groundX -= speed;
  score += 1;

  // Gravity
  playerY += playerVY;
  if (playerY < roadY) playerVY += 0.8; 
  else { playerY = roadY; playerVY = 0; }

  // Obstacles
  if (Math.random() < 0.02) {
    obstacles.push({ x: w, type: Math.random() > 0.8 ? 'ðŸš€' : 'ðŸš§' });
  }

  obstacles.forEach((o, i) => {
    o.x -= speed;
    // Collision
    if (o.x > 50 && o.x < 150 && Math.abs(playerY - roadY) < 20) {
      if (o.type === 'ðŸš§') { gameActive = false; setTimeout(()=>document.getElementById('overlay').style.display='flex', 1000); }
      if (o.type === 'ðŸš€') { speed += 10; obstacles.splice(i, 1); }
    }
  });
  
  document.getElementById('speed').innerText = Math.floor(speed * 10);
  document.getElementById('score').innerText = score;
}

function draw() {
  // Background
  ctx.fillStyle = "#050510"; ctx.fillRect(0,0,w,h);
  
  // Road
  ctx.fillStyle = "#222"; ctx.fillRect(0, roadY, w, h - roadY);
  ctx.strokeStyle = "#0ff"; ctx.lineWidth = 4;
  ctx.setLineDash([40, 20]); ctx.lineDashOffset = groundX;
  ctx.beginPath(); ctx.moveTo(0, roadY + 5); ctx.lineTo(w, roadY + 5); ctx.stroke();

  // Lineup (Front View)
  if (countdown >= 0) {
    ctx.drawImage(imgAzul, w*0.5 - 120, roadY - 100, 100, 100);
    ctx.drawImage(imgMochkil, w*0.5 + 20, roadY - 100, 100, 100);
    ctx.font = "80px serif"; ctx.fillText(['ðŸŸ¢','ðŸŸ¡','ðŸ”´'][countdown-1]||'ðŸŸ¢', w/2-40, h/2);
  }

  // Player (Side View Emoji)
  ctx.font = "80px serif";
  ctx.fillText("ðŸŽï¸", 80, playerY - 10);

  // Obstacles
  obstacles.forEach(o => {
    ctx.font = "50px serif";
    ctx.fillText(o.type, o.x, roadY - 10);
  });

  // Rivals Passing (azul_mochkil_pass.png)
  if (score % 500 > 0 && score % 500 < 50) {
    ctx.drawImage(imgPass, w - (score%500 * 20), roadY - 120, 150, 100);
  }

  requestAnimationFrame(() => { update(); draw(); });
}
draw();
</script>
</body>
</html>
